doctype html
html(ng-app="app")
    head
        title Teptavl（てぷたぶる）
        meta(charset="UTF-8")

        link(rel="stylesheet" href="css/default/easyui.css")
        link(rel="stylesheet" href="css/icon.css")
        link(rel="stylesheet" href="css/style.css")

        script(src="js/jquery-2.1.0.min.js")
        script(src="js/jquery.easyui.min.js")
        script(src="js/angular.min.js")
        script(src="js/angular-cookies.min.js")
        script(src="js/angular-local-storage.min.js")
        script(src="js/mutate.events.js")
        script(src="js/mutate.min.js")
        script(src="js/script.js")

        audio#se(controls=false preload="auto")
            source(src="sound/swing.wav")

    body(ng-controller="TeptavlCtrl")

        div(ng-repeat="(key, windowInfo) in windows" window="windowInfo")
            div(layout ng-if="key === 'main' || key === 'sub'")
                div.lines(data-options="region: 'center'" auto-scroll)
                    p.line(ng-repeat="line in windowInfo.lines") {{line.item}}

                div(data-options="region:'south', split:true" style='height:48px')
                    div(layout)
                        div(data-options="region: 'center'")
                            textarea.input(fit-parent ng-model="windowInfo.input" ng-keyup="updateInput(key, $event.target.value)")

                        div(data-options="region: 'east', split: true" style="width: 64px")
                            button.send(fit-parent ng-click="send(key)") 送信

            div(layout ng-if="key === 'system'")
                div.lines(data-options="region: 'center'" auto-scroll)
                    p.line(ng-repeat="line in windowInfo.lines") {{line.item}}

            div(layout ng-if="key === 'player'")
                div(data-options="region: 'center'")
                    input#playerName(type="text" ng-model="windowInfo.name" fit-parent style="margin: 0px")

            div(layout ng-if="key === 'players'")
                div.lines(data-options="region: 'center'")
                    p.line(ng-repeat="(id, name) in windowInfo.names") {{name}}
